
<!DOCTYPE html>


<html lang="en" data-content_root="./" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>11. Chapter 2: Least Squares Regression &#8212; STAT301@Purdue</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  <!--
    this give us a css class that will be invisible only if js is disabled
  -->
  <noscript>
    <style>
      .pst-js-only { display: none !important; }

    </style>
  </noscript>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="_static/styles/theme.css?digest=8878045cc6db502f8baf" rel="stylesheet" />
<link href="_static/styles/pydata-sphinx-theme.css?digest=8878045cc6db502f8baf" rel="stylesheet" />

    <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=fa44fd50" />
    <link rel="stylesheet" type="text/css" href="_static/styles/sphinx-book-theme.css?v=a3416100" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="_static/proof.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-design.min.css?v=95c83b7e" />
  
  <!-- So that users can add custom icons -->
  <script src="_static/scripts/fontawesome.js?digest=8878045cc6db502f8baf"></script>
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="_static/scripts/bootstrap.js?digest=8878045cc6db502f8baf" />
<link rel="preload" as="script" href="_static/scripts/pydata-sphinx-theme.js?digest=8878045cc6db502f8baf" />

    <script src="_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="_static/doctools.js?v=9a2dae69"></script>
    <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="_static/copybutton.js?v=f281be69"></script>
    <script src="_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="_static/togglebutton.js?v=4a39c7ea"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="_static/design-tabs.js?v=f930bc37"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="_static/sphinx-thebe.js?v=c100c467"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'chapter11';</script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="12. Chapter 10: Inference for Regression" href="chapter12.html" />
    <link rel="prev" title="10. Chapter 2: Looking at Data-Relationships" href="chapter10.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  <meta name="docsearch:version" content="" />
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <dialog id="pst-search-dialog">
    
<form class="bd-search d-flex align-items-center"
      action="search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form>
  </dialog>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <dialog id="pst-primary-sidebar-modal"></dialog>
      <div id="pst-primary-sidebar" class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="intro.html">
  
  
  
  
  
    
    
      
    
    
    <img src="_static/statlogo.png" class="logo__image only-light" alt="STAT301@Purdue - Home"/>
    <img src="_static/statlogo.png" class="logo__image only-dark pst-js-only" alt="STAT301@Purdue - Home"/>
  
  
</a></div>
        <div class="sidebar-primary-item">

<button class="btn search-button-field search-button__button pst-js-only" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
 <i class="fa-solid fa-magnifying-glass"></i>
 <span class="search-button__default-text">Search</span>
 <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
</button></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="intro.html">
                    STAT 301 Introduction
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">At the beginning</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="chapter1.html">1. At the Beginning</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Working with data</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="chapter2.html">2. Some Important Concepts</a></li>
<li class="toctree-l1"><a class="reference internal" href="chapter3.html">3. Chapter 3: Producing Data</a></li>
<li class="toctree-l1"><a class="reference internal" href="chapter4.html">4. Chapter 1: Looking at Data â€“ Distributions</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Making statistical inference</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="chapter5.html">5. Chapter 5: Sampling Distributions</a></li>
<li class="toctree-l1"><a class="reference internal" href="chapter6.html">6. Chapter 6: Confidence Intervals and Significance Tests</a></li>
<li class="toctree-l1"><a class="reference internal" href="chapter7.html">7. Chapter 7: Inference for Means</a></li>
<li class="toctree-l1"><a class="reference internal" href="chapter8.html">8. Chapter 12: One Way ANOVA</a></li>
<li class="toctree-l1"><a class="reference internal" href="chapter9.html">9. Chapter 13: Two Way ANOVA</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Modeling linear regression</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="chapter10.html">10. Chapter 2: Looking at Data-Relationships</a></li>
<li class="toctree-l1 current active"><a class="current reference internal" href="#">11. Chapter 2: Least Squares Regression</a></li>
<li class="toctree-l1"><a class="reference internal" href="chapter12.html">12. Chapter 10: Inference for Regression</a></li>
<li class="toctree-l1"><a class="reference internal" href="chapter13.html">13. Chapter 11: Multiple Regression</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Additional Topics</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="chapter14.html">14. Chapter 2 &amp; 9: Two-Way Tables</a></li>
<li class="toctree-l1"><a class="reference internal" href="chapter15.html">15. Chapter 8: Inference for a Single Proportion</a></li>
<li class="toctree-l1"><a class="reference internal" href="chapter16.html">16. Special Topic: Simple Least Squares Regression in Matrix Form</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
      <div class="sidebar-primary-item">
<div id="ethical-ad-placement"
      class="flat"
      data-ea-publisher="readthedocs"
      data-ea-type="readthedocs-sidebar"
      data-ea-manual="true">
</div></div>
  </div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/executablebooks/jupyter-book" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/executablebooks/jupyter-book/issues/new?title=Issue%20on%20page%20%2Fchapter11.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="_sources/chapter11.md" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.md</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button pst-js-only" aria-label="Color mode" data-bs-title="Color mode"  data-bs-placement="bottom" data-bs-toggle="tooltip">
  <i class="theme-switch fa-solid fa-sun                fa-lg" data-mode="light" title="Light"></i>
  <i class="theme-switch fa-solid fa-moon               fa-lg" data-mode="dark"  title="Dark"></i>
  <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"  title="System Settings"></i>
</button>


<button class="btn btn-sm pst-navbar-icon search-button search-button__button pst-js-only" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
</button>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Chapter 2: Least Squares Regression</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#fitting-a-line-to-data">11.1. Fitting a Line to Data</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#zooming-into-scatterplots">11.2. Zooming into Scatterplots</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#least-squares-regression-line">11.3. Least-Squares Regression Line</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#facts-about-least-squares-regression">11.4. Facts about Least-Squares Regression</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#coefficient-of-determination-r-2-and-square-of-correlation-coefficient-r-2">11.5. Coefficient of Determination (<span class="math notranslate nohighlight">\(R^2\)</span>) and Square of Correlation Coefficient (<span class="math notranslate nohighlight">\(r^2\)</span>)</a></li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="chapter-2-least-squares-regression">
<h1><span class="section-number">11. </span>Chapter 2: Least Squares Regression<a class="headerlink" href="#chapter-2-least-squares-regression" title="Link to this heading">#</a></h1>
<p>In the last chapter, we have seen that we can use a straight line to study the strength of the linear relationship between two quantitative variables in the scatterplots. This line is called a <span style="color:#cfb991"><strong>regression line</strong></span> when one of the variables helps explain or predict the other. That is, regression describes a relationship between a response variable and an explanatory variable. It also allows us to make another type of claim about our dataset (unseen dataset), which is <span style="color:#cfb991"><strong>prediction</strong></span>. Because for every value on the <span class="math notranslate nohighlight">\(x\)</span>-axisâ€”even if we donâ€™t have a corresponding <span class="math notranslate nohighlight">\(x\)</span> value in the datasetâ€”this regression line can still provide a corresponding <span class="math notranslate nohighlight">\(y\)</span> value that can be used as the prediction for the unseen <span class="math notranslate nohighlight">\(x\)</span> value. Prediction is a hot topic nowadays in the era of AI and Machine Learning.</p>
<div class="note admonition">
<p class="admonition-title"><strong>Regression Line</strong></p>
<p>Regression, unlike correlation, requires that we have an <strong>explanatory variable</strong> and a <strong>response variable</strong>.</p>
<p>A <strong>regression line</strong> is a straight line that describes how a response variable <span class="math notranslate nohighlight">\(y\)</span> changes as an explanatory variable <span class="math notranslate nohighlight">\(x\)</span> changes.</p>
<p>We often use a regression line to <strong>predict</strong> the value of <span class="math notranslate nohighlight">\(y\)</span> for a given value of <span class="math notranslate nohighlight">\(x\)</span>.</p>
</div>
<section id="fitting-a-line-to-data">
<h2><span class="section-number">11.1. </span>Fitting a Line to Data<a class="headerlink" href="#fitting-a-line-to-data" title="Link to this heading">#</a></h2>
<ul class="simple">
<li><p>A <strong>scatterplot</strong> displays a <strong>linear pattern</strong>, which can be summarized using a <strong>regression line</strong>.</p></li>
<li><p><strong>Fitting a line</strong> means <em>drawing</em> a line that is as close as possible to the data points.</p></li>
<li><p>The fitted line provides a <strong>numerical summary</strong> of the relationship between:</p>
<ul>
<li><p><strong>Response variable</strong> <span class="math notranslate nohighlight">\(y\)</span></p></li>
<li><p><strong>Explanatory variable</strong> <span class="math notranslate nohighlight">\(x\)</span></p></li>
</ul>
</li>
</ul>
<div class="note admonition">
<p class="admonition-title"><strong>Straight Lines</strong></p>
<ul>
<li><p>A straight-line relationship between <span class="math notranslate nohighlight">\(y\)</span> and <span class="math notranslate nohighlight">\(x\)</span> is given by:</p>
<div class="math notranslate nohighlight">
\[
  y = b_0 + b_1x
  \]</div>
</li>
<li><p><strong>Interpretation of coefficients</strong>:</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(b_1\)</span> (<strong>slope</strong>): Change in <span class="math notranslate nohighlight">\(y\)</span> for a one-unit increase in <span class="math notranslate nohighlight">\(x\)</span>.</p></li>
<li><p><span class="math notranslate nohighlight">\(b_0\)</span> (<strong>intercept</strong>): Value of <span class="math notranslate nohighlight">\(y\)</span> when <span class="math notranslate nohighlight">\(x = 0\)</span>.</p></li>
</ul>
</li>
<li><p><strong>Software</strong> is used to compute <span class="math notranslate nohighlight">\(b_0\)</span> and <span class="math notranslate nohighlight">\(b_1\)</span> for a given dataset.</p></li>
</ul>
</div>
<p>There are of course many methods to <em>draw</em> a line across the data points in a scatterplot. You can randomly draw a line, but one observation is that no line can pass exactly through all the data points. There are also many methods to determine the closeness between the line and the data points. Different methods will give us different pairs of values <span class="math notranslate nohighlight">\((b_0, b_1)\)</span>. Once we obtain these parameter values, we can use the regression line as the <strong>prediction</strong> of our response variable <span class="math notranslate nohighlight">\(y\)</span> because we can use a particular unknown explanatory <span class="math notranslate nohighlight">\(x\)</span> value as the input, and it will give us the output prediction. We call this prediction <strong><span class="math notranslate nohighlight">\(\hat{y}\)</span></strong>. Before we discuss the interpretation of the prediction, letâ€™s dive a little deeper into the scatterplot to see behind the scenes how we can start from the scatterplot and obtain a <strong>Least Squares Regression Line</strong>.</p>
<figure class="align-center">
<a class="reference internal image-reference" href="_images/1101.png"><img alt="Regression Lines" src="_images/1101.png" style="width: 100%;" /></a>
</figure>
</section>
<section id="zooming-into-scatterplots">
<h2><span class="section-number">11.2. </span>Zooming into Scatterplots<a class="headerlink" href="#zooming-into-scatterplots" title="Link to this heading">#</a></h2>
<p>Here we have a scatterplot (top left corner) showing many data points of the two component scores, Verbal and Math, for 200 students. The <span class="math notranslate nohighlight">\(x\)</span>-axis represents their Verbal scores and the <span class="math notranslate nohighlight">\(y\)</span>-axis represents their Math scores. As the number of data points increases, it becomes challenging to discern relationships clearly. However, we can see that for some of the data points, they share the same <span class="math notranslate nohighlight">\(x\)</span>-value. In these cases, the Verbal scores are identical while the Math scores differ among the students. We can focus on these data points with the same <span class="math notranslate nohighlight">\(x\)</span>-value, treating them as a <strong>subpopulation</strong>. By calculating the means of these points, we can better understand the relationship. We can do this for all subpopulations; these means are called the <em>conditional means</em> because they are conditioned on the same <span class="math notranslate nohighlight">\(x\)</span>-value. Then the scatterplot simplifies to the second plot, which is at the top right corner. For each <span class="math notranslate nohighlight">\(x\)</span>-value in this plot, we only have one <span class="math notranslate nohighlight">\(y\)</span>-value representing the conditional mean or average. We can interpret this as the <strong>average value</strong> of the Math score for a collection of cases at a given Verbal score.</p>
<p>In the third plot (bottom right corner), we fit a straight line through these conditional means, summarizing these means with a line. Finally, the last plot (bottom left corner) shows the original data points along with this straight regression line.</p>
<blockquote>
<div><p>One thing to notice is that the regression line cannot pass through every data point and conditional mean exactly. For each data point, there is a vertical distance between the point and the line. We can calculate this distance using the formula <span class="math notranslate nohighlight">\(e = y - \hat{y}\)</span>, which is called the residual.</p>
</div></blockquote>
<figure class="align-center">
<a class="reference internal image-reference" href="_images/1102.png"><img alt="Regression Lines" src="_images/1102.png" style="width: 100%;" /></a>
</figure>
<div class="sd-tab-set docutils">
<input checked="checked" id="sd-tab-item-0" name="sd-tab-set-0" type="radio">
<label class="sd-tab-label" for="sd-tab-item-0">
Example: IDI and MI</label><div class="sd-tab-content docutils">
<figure class="align-center">
<a class="reference internal image-reference" href="_images/1103.png"><img alt="Scatterplot of IDI and MI" src="_images/1103.png" style="width: 70%;" /></a>
</figure>
</div>
<input id="sd-tab-item-1" name="sd-tab-set-0" type="radio">
<label class="sd-tab-label" for="sd-tab-item-1">
Example: Prediction of IDI</label><div class="sd-tab-content docutils">
<figure class="align-center">
<a class="reference internal image-reference" href="_images/1104.png"><img alt="Prediction of IDI" src="_images/1104.png" style="width: 70%;" /></a>
</figure>
</div>
<input id="sd-tab-item-2" name="sd-tab-set-0" type="radio">
<label class="sd-tab-label" for="sd-tab-item-2">
Example: The Least-Squares Idea</label><div class="sd-tab-content docutils">
<figure class="align-center">
<a class="reference internal image-reference" href="_images/1105.png"><img alt="The Least-Squares Idea" src="_images/1105.png" style="width: 70%;" /></a>
</figure>
</div>
</div>
</section>
<section id="least-squares-regression-line">
<h2><span class="section-number">11.3. </span>Least-Squares Regression Line<a class="headerlink" href="#least-squares-regression-line" title="Link to this heading">#</a></h2>
<p>We can use a <strong>regression line</strong> to make a <strong>prediction</strong> of the response <span class="math notranslate nohighlight">\(y\)</span> for a specific value of the explanatory variable <span class="math notranslate nohighlight">\(x\)</span>.</p>
<ul class="simple">
<li><p>The prediction can be interpreted as:</p>
<ul>
<li><p>The <strong>average value</strong> of <span class="math notranslate nohighlight">\(y\)</span> for a collection of cases at a given <span class="math notranslate nohighlight">\(x\)</span>.</p></li>
<li><p>The <strong>best guess</strong> of <span class="math notranslate nohighlight">\(y\)</span> for an individual case at that particular <span class="math notranslate nohighlight">\(x\)</span>.</p></li>
</ul>
</li>
</ul>
<div class="note admonition">
<p class="admonition-title"><strong>Least-Squares Regression Line</strong></p>
<p>The <strong>least-squares regression line of <span class="math notranslate nohighlight">\(y\)</span> on <span class="math notranslate nohighlight">\(x\)</span></strong> is the line that minimizes the <strong>sum of the squared vertical distances</strong> between the data points and the line.</p>
<ul class="simple">
<li><p>We frequently use the terms <strong>regression line</strong> or <strong>least-squares line</strong> to describe this.</p></li>
</ul>
</div>
<div class="note admonition">
<p class="admonition-title"><strong>Equation of the Least-Squares Regression Line</strong></p>
<p>We have data on an <strong>explanatory variable</strong> <span class="math notranslate nohighlight">\(x\)</span> and a <strong>response variable</strong> <span class="math notranslate nohighlight">\(y\)</span> for <span class="math notranslate nohighlight">\(n\)</span> individuals.</p>
<ul class="simple">
<li><p>The <strong>means</strong> and <strong>standard deviations</strong> of the sample data:</p>
<ul>
<li><p><span class="math notranslate nohighlight">\(\bar{x}\)</span> and <span class="math notranslate nohighlight">\(s_x\)</span> for <span class="math notranslate nohighlight">\(x\)</span>.</p></li>
<li><p><span class="math notranslate nohighlight">\(\bar{y}\)</span> and <span class="math notranslate nohighlight">\(s_y\)</span> for <span class="math notranslate nohighlight">\(y\)</span>.</p></li>
</ul>
</li>
<li><p>The <strong>correlation coefficient</strong> between <span class="math notranslate nohighlight">\(x\)</span> and <span class="math notranslate nohighlight">\(y\)</span> is <span class="math notranslate nohighlight">\(r\)</span>.</p></li>
</ul>
<p>The <strong>equation of the least-squares regression line</strong> of <span class="math notranslate nohighlight">\(y\)</span> on <span class="math notranslate nohighlight">\(x\)</span> is:</p>
<div class="math notranslate nohighlight">
\[
\hat{y} = b_0 + b_1 x
\]</div>
<ul>
<li><p><strong>Slope</strong></p>
<div class="math notranslate nohighlight">
\[
  b_1 = r \frac{s_y}{s_x}
  \]</div>
</li>
<li><p><strong>Intercept</strong></p>
<div class="math notranslate nohighlight">
\[
  b_0 = \bar{y} - b_1 \bar{x}
  \]</div>
</li>
</ul>
<p><span class="math notranslate nohighlight">\(b_0\)</span> and <span class="math notranslate nohighlight">\(b_1\)</span> are the <strong>regression coefficients</strong> of the least-squares equation.</p>
</div>
</section>
<section id="facts-about-least-squares-regression">
<h2><span class="section-number">11.4. </span>Facts about Least-Squares Regression<a class="headerlink" href="#facts-about-least-squares-regression" title="Link to this heading">#</a></h2>
<p>The use of regression to describe the relationship between a <strong>response variable</strong> and an <strong>explanatory variable</strong> is one of the most commonly encountered statistical methods. Least-squares regression is the most commonly used technique for fitting a regression line to data. Here are some key facts about least-squares regression lines.</p>
<ul>
<li><p><strong>Fact 1</strong>: Connection Between Correlation and Slope</p>
<p>There is a close connection between <strong>correlation</strong> and the <strong>slope</strong> of the least-squares line.<br />
The slope is given by:</p>
<div class="math notranslate nohighlight">
\[
  b_1 = r \frac{s_y}{s_x}
  \]</div>
<ul class="simple">
<li><p>This equation states that <strong>a change of 1 standard deviation in <span class="math notranslate nohighlight">\(x\)</span> corresponds to a change of <span class="math notranslate nohighlight">\(r\)</span> standard deviations in <span class="math notranslate nohighlight">\(y\)</span></strong>.</p></li>
<li><p>If <span class="math notranslate nohighlight">\(r = 1\)</span> or <span class="math notranslate nohighlight">\(r = -1\)</span>, the <strong>change in <span class="math notranslate nohighlight">\(\hat{y}\)</span></strong> is the same (in standard deviation units) as in <span class="math notranslate nohighlight">\(x\)</span>.</p></li>
<li><p>If <span class="math notranslate nohighlight">\(-1 \leq r \leq 1\)</span>, the change in <span class="math notranslate nohighlight">\(\hat{y}\)</span> is <strong>less</strong> than the change in <span class="math notranslate nohighlight">\(x\)</span>.</p></li>
<li><p>As <strong>correlation weakens</strong>, the predicted <span class="math notranslate nohighlight">\(\hat{y}\)</span> moves <strong>less</strong> in response to changes in <span class="math notranslate nohighlight">\(x\)</span>.</p></li>
<li><p>If <strong>correlation is zero</strong>, the slope of the regression line is <strong>zero</strong>.</p></li>
</ul>
</li>
<li><p><strong>Fact 2</strong>: The Least-Squares Regression Line Passes Through <span class="math notranslate nohighlight">\((\bar{x}, \bar{y})\)</span></p>
<ul class="simple">
<li><p>The <strong>least-squares regression line always passes through</strong> the point <span class="math notranslate nohighlight">\((\bar{x}, \bar{y})\)</span> on the graph of <span class="math notranslate nohighlight">\(y\)</span> against <span class="math notranslate nohighlight">\(x\)</span>.</p></li>
<li><p>This means the regression line of <span class="math notranslate nohighlight">\(y\)</span> on <span class="math notranslate nohighlight">\(x\)</span> is:</p>
<ul>
<li><p>A line with <strong>slope</strong> <span class="math notranslate nohighlight">\(r \frac{s_y}{s_x}\)</span> that <strong>passes through <span class="math notranslate nohighlight">\((\bar{x}, \bar{y})\)</span></strong>.</p></li>
</ul>
</li>
<li><p>Regression can be <strong>fully described</strong> in terms of the basic measures: <span class="math notranslate nohighlight">\(\bar{x}, s_x, \bar{y}, s_y, r\)</span>.</p></li>
</ul>
</li>
<li><p><strong>Fact 3</strong>: Explanatory and Response Variable Roles Matter</p>
<ul class="simple">
<li><p><strong>Regression considers distances from the line only in the <span class="math notranslate nohighlight">\(y\)</span>-direction</strong>.</p></li>
<li><p>If we <strong>switch the roles</strong> of <span class="math notranslate nohighlight">\(x\)</span> and <span class="math notranslate nohighlight">\(y\)</span>, we obtain <strong>a different regression line</strong>.</p></li>
</ul>
</li>
</ul>
</section>
<section id="coefficient-of-determination-r-2-and-square-of-correlation-coefficient-r-2">
<h2><span class="section-number">11.5. </span>Coefficient of Determination (<span class="math notranslate nohighlight">\(R^2\)</span>) and Square of Correlation Coefficient (<span class="math notranslate nohighlight">\(r^2\)</span>)<a class="headerlink" href="#coefficient-of-determination-r-2-and-square-of-correlation-coefficient-r-2" title="Link to this heading">#</a></h2>
<p>In the one-way ANOVA chapter, we have studied the coefficient of determination, <span class="math notranslate nohighlight">\(R^2\)</span>, which represents the proportion of variance in the dependent variable <span class="math notranslate nohighlight">\(y\)</span> that is explained by the independent variable <span class="math notranslate nohighlight">\(x\)</span> in the regression model. For a simple linear regression model, where we have only one independent variable, this <span class="math notranslate nohighlight">\(R^2\)</span> is equal to the square of the correlation coefficient, <span class="math notranslate nohighlight">\(r^2\)</span>, and it is also a measure of <strong>how well the regression explains the response</strong>.</p>
<ul class="simple">
<li><p><strong>Correlation</strong> <span class="math notranslate nohighlight">\(r\)</span> ignores the distinction between <strong>explanatory</strong> and <strong>response variables</strong>.</p></li>
<li><p>There is a <strong>strong connection</strong> between correlation and regression.</p></li>
<li><p>The <strong>slope</strong> of the <strong>least-squares regression line</strong> involves <span class="math notranslate nohighlight">\(r\)</span>.</p></li>
<li><p>The <strong>numerical value of</strong> <span class="math notranslate nohighlight">\(r\)</span> measures the <strong>strength of a linear relationship</strong>.</p></li>
</ul>
<div class="note admonition">
<p class="admonition-title"><strong><span class="math notranslate nohighlight">\(R^2\)</span> in Regression</strong></p>
<ul class="simple">
<li><p>The <strong>square of the correlation</strong> <span class="math notranslate nohighlight">\(r^2\)</span> represents the fraction of the variation in <span class="math notranslate nohighlight">\(y\)</span> <strong>explained</strong> by the least-squares regression of <span class="math notranslate nohighlight">\(y\)</span> on <span class="math notranslate nohighlight">\(x\)</span>.</p></li>
<li><p>Thus, <span class="math notranslate nohighlight">\(r^2\)</span> is a measure of <strong>how well the regression explains the response</strong>.</p></li>
</ul>
</div>
<blockquote>
<div><p>For simple linear regression,</p>
</div></blockquote>
<div class="math notranslate nohighlight">
\[\begin{split}R^2 \longleftrightarrow \text{Proportion of variance in } Y \text{ explained by } X \\
\longleftrightarrow [\mathrm{corr}(Y,\hat{Y})]^2 \\
\longleftrightarrow [\mathrm{corr}(Y,b_0 + b_1 X)]^2 \;=\; [\pm\,\mathrm{corr}(X,Y)]^2 \;=\; [\mathrm{corr}(X,Y)]^2 \\
\longleftrightarrow r^2.\end{split}\]</div>
<div class="note admonition">
<p class="admonition-title"><strong>Interpretation of <span class="math notranslate nohighlight">\(r^2\)</span></strong></p>
<p>The <strong>square of the correlation</strong> <span class="math notranslate nohighlight">\(r^2\)</span> describes the <strong>variation explained</strong> by the least-squares regression.</p>
<ul>
<li><p>Suppose we want to <strong>predict</strong> a new value of <span class="math notranslate nohighlight">\(y\)</span>.</p></li>
<li><p>Without additional information, the <strong>best estimate</strong> is the sample mean <span class="math notranslate nohighlight">\(\bar{y}\)</span>.</p></li>
<li><p>If an <strong>explanatory variable</strong> <span class="math notranslate nohighlight">\(x\)</span> is available, we use the <strong>regression equation</strong>:</p>
<div class="math notranslate nohighlight">
\[
  \hat{y} = b_0 + b_1 x
  \]</div>
</li>
</ul>
<p>This prediction <strong>accounts for</strong> the value of <span class="math notranslate nohighlight">\(x\)</span>.</p>
<ul>
<li><p>Comparing Prediction Methods</p>
<ul>
<li><p>Without <span class="math notranslate nohighlight">\(x\)</span>:</p>
<ul class="simple">
<li><p>We predict using <span class="math notranslate nohighlight">\(\bar{y}\)</span>.</p></li>
<li><p>The difference between observed and predicted values is <span class="math notranslate nohighlight">\(y - \bar{y}\)</span>.</p></li>
</ul>
</li>
<li><p>With <span class="math notranslate nohighlight">\(x\)</span>:</p>
<ul class="simple">
<li><p>We predict using <span class="math notranslate nohighlight">\(\hat{y}\)</span>.</p></li>
<li><p>The difference is <span class="math notranslate nohighlight">\(y - \hat{y}\)</span>.</p></li>
</ul>
</li>
<li><p>The use of <span class="math notranslate nohighlight">\(x\)</span> <strong>changes the error</strong> from <span class="math notranslate nohighlight">\(y - \bar{y}\)</span> to <span class="math notranslate nohighlight">\(y - \hat{y}\)</span>.</p></li>
<li><p>We compare the <strong>sums of squares</strong> of these differences:</p>
<div class="math notranslate nohighlight">
\[
    r^2 = \frac{\sum (\hat{y} - \bar{y})^2}{\sum (y - \bar{y})^2}
    \]</div>
</li>
<li><p>The <strong>numerator</strong> represents the <strong>variation in <span class="math notranslate nohighlight">\(y\)</span> explained by <span class="math notranslate nohighlight">\(x\)</span></strong>.</p></li>
<li><p>The <strong>denominator</strong> represents the <strong>total variation in <span class="math notranslate nohighlight">\(y\)</span></strong>.</p></li>
</ul>
</li>
</ul>
<blockquote>
<div><p>In <strong>Chapter 11 of the textbook</strong>, where <span class="math notranslate nohighlight">\(\hat{y}\)</span> is based on <strong>multiple explanatory variables</strong>, we use <span class="math notranslate nohighlight">\(R^2\)</span> to denote the <strong>coefficient of determination</strong>.</p>
</div></blockquote>
</div>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="chapter10.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title"><span class="section-number">10. </span>Chapter 2: Looking at Data-Relationships</p>
      </div>
    </a>
    <a class="right-next"
       href="chapter12.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title"><span class="section-number">12. </span>Chapter 10: Inference for Regression</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <dialog id="pst-secondary-sidebar-modal"></dialog>
                <div id="pst-secondary-sidebar" class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#fitting-a-line-to-data">11.1. Fitting a Line to Data</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#zooming-into-scatterplots">11.2. Zooming into Scatterplots</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#least-squares-regression-line">11.3. Least-Squares Regression Line</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#facts-about-least-squares-regression">11.4. Facts about Least-Squares Regression</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#coefficient-of-determination-r-2-and-square-of-correlation-coefficient-r-2">11.5. Coefficient of Determination (<span class="math notranslate nohighlight">\(R^2\)</span>) and Square of Correlation Coefficient (<span class="math notranslate nohighlight">\(r^2\)</span>)</a></li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Frank (Chenzhong) Wu
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      Â© Copyright 2024.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script defer src="_static/scripts/bootstrap.js?digest=8878045cc6db502f8baf"></script>
<script defer src="_static/scripts/pydata-sphinx-theme.js?digest=8878045cc6db502f8baf"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>