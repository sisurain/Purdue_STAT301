
<!DOCTYPE html>


<html lang="en" data-content_root="./" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>13. Chapter 11: Multiple Regression &#8212; STAT301@Purdue</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  <!--
    this give us a css class that will be invisible only if js is disabled
  -->
  <noscript>
    <style>
      .pst-js-only { display: none !important; }

    </style>
  </noscript>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="_static/styles/theme.css?digest=8878045cc6db502f8baf" rel="stylesheet" />
<link href="_static/styles/pydata-sphinx-theme.css?digest=8878045cc6db502f8baf" rel="stylesheet" />

    <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=fa44fd50" />
    <link rel="stylesheet" type="text/css" href="_static/styles/sphinx-book-theme.css?v=a3416100" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="_static/proof.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-design.min.css?v=95c83b7e" />
  
  <!-- So that users can add custom icons -->
  <script src="_static/scripts/fontawesome.js?digest=8878045cc6db502f8baf"></script>
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="_static/scripts/bootstrap.js?digest=8878045cc6db502f8baf" />
<link rel="preload" as="script" href="_static/scripts/pydata-sphinx-theme.js?digest=8878045cc6db502f8baf" />

    <script src="_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="_static/doctools.js?v=9a2dae69"></script>
    <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="_static/copybutton.js?v=f281be69"></script>
    <script src="_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="_static/togglebutton.js?v=4a39c7ea"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="_static/design-tabs.js?v=f930bc37"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="_static/sphinx-thebe.js?v=c100c467"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'chapter13';</script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="14. Chapter 2 &amp; 9: Two-Way Tables" href="chapter14.html" />
    <link rel="prev" title="12. Chapter 10: Inference for Regression" href="chapter12.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  <meta name="docsearch:version" content="" />
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <dialog id="pst-search-dialog">
    
<form class="bd-search d-flex align-items-center"
      action="search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form>
  </dialog>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <dialog id="pst-primary-sidebar-modal"></dialog>
      <div id="pst-primary-sidebar" class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="intro.html">
  
  
  
  
  
    
    
      
    
    
    <img src="_static/statlogo.png" class="logo__image only-light" alt="STAT301@Purdue - Home"/>
    <img src="_static/statlogo.png" class="logo__image only-dark pst-js-only" alt="STAT301@Purdue - Home"/>
  
  
</a></div>
        <div class="sidebar-primary-item">

<button class="btn search-button-field search-button__button pst-js-only" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
 <i class="fa-solid fa-magnifying-glass"></i>
 <span class="search-button__default-text">Search</span>
 <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
</button></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="intro.html">
                    STAT 301 Introduction
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">At the beginning</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="chapter1.html">1. At the Beginning</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Working with data</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="chapter2.html">2. Some Important Concepts</a></li>
<li class="toctree-l1"><a class="reference internal" href="chapter3.html">3. Chapter 3: Producing Data</a></li>
<li class="toctree-l1"><a class="reference internal" href="chapter4.html">4. Chapter 1: Looking at Data – Distributions</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Making statistical inference</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="chapter5.html">5. Chapter 5: Sampling Distributions</a></li>
<li class="toctree-l1"><a class="reference internal" href="chapter6.html">6. Chapter 6: Confidence Intervals and Significance Tests</a></li>
<li class="toctree-l1"><a class="reference internal" href="chapter7.html">7. Chapter 7: Inference for Means</a></li>
<li class="toctree-l1"><a class="reference internal" href="chapter8.html">8. Chapter 12: One Way ANOVA</a></li>
<li class="toctree-l1"><a class="reference internal" href="chapter9.html">9. Chapter 13: Two Way ANOVA</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Modeling linear regression</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="chapter10.html">10. Chapter 2: Looking at Data-Relationships</a></li>
<li class="toctree-l1"><a class="reference internal" href="chapter11.html">11. Chapter 2: Least Squares Regression</a></li>
<li class="toctree-l1"><a class="reference internal" href="chapter12.html">12. Chapter 10: Inference for Regression</a></li>
<li class="toctree-l1 current active"><a class="current reference internal" href="#">13. Chapter 11: Multiple Regression</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Additional Topics</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="chapter14.html">14. Chapter 2 &amp; 9: Two-Way Tables</a></li>
<li class="toctree-l1"><a class="reference internal" href="chapter15.html">15. Chapter 8: Inference for a Single Proportion</a></li>
<li class="toctree-l1"><a class="reference internal" href="chapter16.html">16. Special Topic: Simple Least Squares Regression in Matrix Form</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
      <div class="sidebar-primary-item">
<div id="ethical-ad-placement"
      class="flat"
      data-ea-publisher="readthedocs"
      data-ea-type="readthedocs-sidebar"
      data-ea-manual="true">
</div></div>
  </div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/executablebooks/jupyter-book" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/executablebooks/jupyter-book/issues/new?title=Issue%20on%20page%20%2Fchapter13.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="_sources/chapter13.md" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.md</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button pst-js-only" aria-label="Color mode" data-bs-title="Color mode"  data-bs-placement="bottom" data-bs-toggle="tooltip">
  <i class="theme-switch fa-solid fa-sun                fa-lg" data-mode="light" title="Light"></i>
  <i class="theme-switch fa-solid fa-moon               fa-lg" data-mode="dark"  title="Dark"></i>
  <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"  title="System Settings"></i>
</button>


<button class="btn btn-sm pst-navbar-icon search-button search-button__button pst-js-only" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
</button>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Chapter 11: Multiple Regression</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#the-model-and-estimation">13.1. The model and estimation</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#confidence-intervals-significant-tests-and-anova">13.2. Confidence intervals, significant tests and ANOVA</a></li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="chapter-11-multiple-regression">
<h1><span class="section-number">13. </span>Chapter 11: Multiple Regression<a class="headerlink" href="#chapter-11-multiple-regression" title="Link to this heading">#</a></h1>
<p>In Chapters 2 and 10, we studied methods for inference in the setting of a linear relationship between a quantitative response variable <span class="math notranslate nohighlight">\(y\)</span> and a <em>single</em> explanatory variable <span class="math notranslate nohighlight">\(x\)</span>. In this chapter, we investigate situations in which <em>multiple</em> explanatory variables work together to explain, or predict, the response variable.</p>
<p>Here are some examples. See if you can identify the response and explanatory variables as well as determine whether each explanatory variable is quantitative or categorical.</p>
<p><strong>Data for Multiple Regression</strong></p>
<p>The data for a simple linear regression problem consist of <span class="math notranslate nohighlight">\(n\)</span> pairs of a response variable <span class="math notranslate nohighlight">\(y\)</span> and an explanatory variable <span class="math notranslate nohighlight">\(x\)</span>. Because there are several explanatory variables in multiple regression, the notation needed to describe the data is more elaborate.</p>
<p>Each observation (or case) consists of a value for the response variable and for each of the explanatory variables. Call <span class="math notranslate nohighlight">\(x_{ij}\)</span> the value of the <span class="math notranslate nohighlight">\(j\)</span>th explanatory variable for the <span class="math notranslate nohighlight">\(i\)</span>th case. The data are then:</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{aligned}
\text{Case 1:} &amp; \quad (y_1, x_{11}, x_{12}, \ldots, x_{1p}) \\
\text{Case 2:} &amp; \quad (y_2, x_{21}, x_{22}, \ldots, x_{2p}) \\
&amp; \quad \vdots \\
\text{Case n:} &amp; \quad (y_n, x_{n1}, x_{n2}, \ldots, x_{np})
\end{aligned}\end{split}\]</div>
<p>Here, <span class="math notranslate nohighlight">\(n\)</span> is the number of cases, and <span class="math notranslate nohighlight">\(p\)</span> is the number of explanatory variables.</p>
<p>Data are often entered into computer regression programs in this format. Each row is a case, and each column corresponds to a different variable.</p>
<p><strong>Population Multiple Regression Equation</strong></p>
<p>The simple linear regression model assumes that the mean of the response variable <span class="math notranslate nohighlight">\(y\)</span> depends on the explanatory variable <span class="math notranslate nohighlight">\(x\)</span> according to a linear equation:</p>
<div class="math notranslate nohighlight">
\[\mu_y = \beta_0 + \beta_1 x\]</div>
<p>For any fixed value of <span class="math notranslate nohighlight">\(x\)</span>, the response <span class="math notranslate nohighlight">\(y\)</span> varies Normally about this mean and has a standard deviation <span class="math notranslate nohighlight">\(\sigma\)</span> that is the same for all values of <span class="math notranslate nohighlight">\(x\)</span>.</p>
<p>In the multiple regression setting, the response variable <span class="math notranslate nohighlight">\(y\)</span> depends on <span class="math notranslate nohighlight">\(p\)</span> explanatory variables, which we denote by <span class="math notranslate nohighlight">\(x_1, x_2, \ldots, x_p\)</span>. The mean response depends on these variables according to the linear function:</p>
<div class="math notranslate nohighlight">
\[\mu_y = \beta_0 + \beta_1 x_1 + \beta_2 x_2 + \cdots + \beta_p x_p\]</div>
<p>This expression is the <strong>population regression equation</strong>, and the observed values <span class="math notranslate nohighlight">\(y\)</span> vary about their means given by this equation.</p>
<p>As in simple linear regression, we can also think of this model in terms of subpopulations of responses. Each subpopulation corresponds to a particular set of values for all the explanatory variables <span class="math notranslate nohighlight">\(x_1, x_2, \ldots, x_p\)</span>.</p>
<p>In each subpopulation, <span class="math notranslate nohighlight">\(y\)</span> varies Normally with a mean given by the population regression equation. The regression model assumes that the standard deviation <span class="math notranslate nohighlight">\(\sigma\)</span> of the responses is the same in all subpopulations.</p>
<section id="the-model-and-estimation">
<h2><span class="section-number">13.1. </span>The model and estimation<a class="headerlink" href="#the-model-and-estimation" title="Link to this heading">#</a></h2>
<div class="sd-tab-set docutils">
<input checked="checked" id="sd-tab-item-0" name="sd-tab-set-0" type="radio">
<label class="sd-tab-label" for="sd-tab-item-0">
Multiple Linear Regression Model</label><div class="sd-tab-content docutils">
<p>Similar to simple linear regression, we combine the population regression equation and the assumptions about how the observed <span class="math notranslate nohighlight">\(y\)</span> vary about their means to form the <strong>multiple linear regression model</strong>. The subpopulation means describe the FIT part of our conceptual model:</p>
<div class="math notranslate nohighlight">
\[\text{DATA} = \text{FIT} + \text{RESIDUAL}.\]</div>
<p>The RESIDUAL part represents how observed <span class="math notranslate nohighlight">\(y\)</span> deviate from their means.</p>
<p>We reuse the notation <span class="math notranslate nohighlight">\(\epsilon\)</span> for the deviation of an individual observation from its subpopulation mean. These <span class="math notranslate nohighlight">\(\epsilon_i\)</span> are assumed to be Normally distributed with mean 0 and the same standard deviation <span class="math notranslate nohighlight">\(\sigma\)</span>, regardless of the <span class="math notranslate nohighlight">\(x\)</span> values.</p>
<div class="tip admonition">
<p class="admonition-title">MULTIPLE LINEAR REGRESSION MODEL</p>
<p>The <strong>multiple linear regression model</strong> is:</p>
<div class="math notranslate nohighlight">
\[y_i 
= \beta_0 
  + \beta_1 x_{i1} 
  + \beta_2 x_{i2} 
  + \cdots 
  + \beta_p x_{ip} 
  + \epsilon_i 
\quad \text{for } i = 1, 2, \ldots, n,\]</div>
<p>where the mean response is</p>
<div class="math notranslate nohighlight">
\[\mu_y 
= \beta_0 
  + \beta_1 x_1 
  + \beta_2 x_2 
  + \cdots 
  + \beta_p x_p.\]</div>
<p>This is the <strong>population regression equation</strong>. The errors <span class="math notranslate nohighlight">\(\epsilon_i\)</span> are independent, Normal(0, <span class="math notranslate nohighlight">\(\sigma\)</span>).</p>
<p>The parameters of the model are the regression coefficients <span class="math notranslate nohighlight">\(\beta_0, \beta_1, \ldots, \beta_p\)</span> and the model standard deviation <span class="math notranslate nohighlight">\(\sigma\)</span>.</p>
</div>
</div>
<input id="sd-tab-item-1" name="sd-tab-set-0" type="radio">
<label class="sd-tab-label" for="sd-tab-item-1">
Interpretation of Multiple Regression Coefficients</label><div class="sd-tab-content docutils">
<p>The assumption that</p>
<div class="math notranslate nohighlight">
\[\mu_y 
= \beta_0 
  + \beta_1 x_1 
  + \beta_2 x_2 
  + \cdots 
  + \beta_p x_p\]</div>
<p>links each subpopulation mean to the regression coefficients.</p>
<p><strong>Key points</strong> on interpretation:</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(\beta_0\)</span> is the mean of <span class="math notranslate nohighlight">\(y\)</span> when all <span class="math notranslate nohighlight">\(x\)</span> variables are 0 (often not of direct interest).</p></li>
<li><p>Each <span class="math notranslate nohighlight">\(\beta_j\)</span> (for <span class="math notranslate nohighlight">\(j \ge 1\)</span>) resembles a slope <strong>only</strong> if the other <span class="math notranslate nohighlight">\(x\)</span> variables stay fixed.</p></li>
<li><p>If <span class="math notranslate nohighlight">\(x\)</span> variables are correlated, changes in one <span class="math notranslate nohighlight">\(x\)</span> may coincide with changes in others, complicating direct interpretation.</p></li>
</ul>
</div>
<input id="sd-tab-item-2" name="sd-tab-set-0" type="radio">
<label class="sd-tab-label" for="sd-tab-item-2">
Estimation of the Multiple Regression Parameters</label><div class="sd-tab-content docutils">
<p>As in simple linear regression, we apply the <strong>least squares method</strong> to estimate the unknown coefficients. Let</p>
<div class="math notranslate nohighlight">
\[b_0,\; b_1,\; b_2,\; \ldots,\; b_p\]</div>
<p>be the estimators for</p>
<div class="math notranslate nohighlight">
\[\beta_0,\; \beta_1,\; \beta_2,\; \ldots,\; \beta_p.\]</div>
<p>Then, the predicted response for the <span class="math notranslate nohighlight">\(i\)</span>th observation is:</p>
<div class="math notranslate nohighlight">
\[\hat{y}_i 
= b_0 
  + b_1 x_{i1} 
  + b_2 x_{i2} 
  + \cdots 
  + b_p x_{ip}.\]</div>
<p>The <strong>residual</strong> is:</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{aligned}
e_i 
&amp;= y_i \;-\; \hat{y}_i \\
&amp;= y_i 
   - b_0 
   - b_1 x_{i1} 
   - b_2 x_{i2} 
   - \cdots 
   - b_p x_{ip}.
\end{aligned}\end{split}\]</div>
<p>The least squares estimates <span class="math notranslate nohighlight">\((b_0, b_1, \ldots, b_p)\)</span> minimize the <strong>sum of squared residuals</strong>:</p>
<div class="math notranslate nohighlight">
\[\sum \Bigl(y_i 
      - b_0 
      - b_1 x_{i1} 
      - \cdots 
      - b_p x_{ip}
\Bigr)^2.\]</div>
</div>
<input id="sd-tab-item-3" name="sd-tab-set-0" type="radio">
<label class="sd-tab-label" for="sd-tab-item-3">
Estimating the Regression Standard Deviation</label><div class="sd-tab-content docutils">
<p>The actual formulas for these least-squares estimates are more involved in multiple regression, so we rely on statistical software to solve them.</p>
<p>We measure the variability of <span class="math notranslate nohighlight">\(y\)</span> around the regression equation by <span class="math notranslate nohighlight">\(\sigma^2\)</span>. To estimate <span class="math notranslate nohighlight">\(\sigma\)</span>, we average the squared residuals:</p>
<div class="math notranslate nohighlight">
\[s^2 
= \frac{\sum e_i^2}{\,n - p - 1\,}
= \frac{\sum (y_i - \hat{y}_i)^2}{\,n - p - 1\,},
\quad
s = \sqrt{s^2}.\]</div>
<div class="tip admonition">
<p class="admonition-title">ESTIMATING THE REGRESSION PARAMETERS</p>
<p>In multiple regression, <strong>least squares</strong> is used to estimate the population coefficients.</p>
<p>The model standard deviation <span class="math notranslate nohighlight">\(\sigma\)</span> is estimated by the <strong>regression standard error</strong>:</p>
<div class="math notranslate nohighlight">
\[s 
= \sqrt{
    \frac{1}{\,n - p - 1\,}
    \sum (y_i - \hat{y}_i)^2
  }.\]</div>
</div>
</div>
</div>
</section>
<section id="confidence-intervals-significant-tests-and-anova">
<h2><span class="section-number">13.2. </span>Confidence intervals, significant tests and ANOVA<a class="headerlink" href="#confidence-intervals-significant-tests-and-anova" title="Link to this heading">#</a></h2>
<div class="sd-tab-set docutils">
<input checked="checked" id="sd-tab-item-4" name="sd-tab-set-1" type="radio">
<label class="sd-tab-label" for="sd-tab-item-4">
Confidence Intervals &amp; Significance Tests for Regression Coefficients</label><div class="sd-tab-content docutils">
<p>We can obtain confidence intervals and perform significance tests for each of the regression coefficients <span class="math notranslate nohighlight">\(\beta_j\)</span> as we did in simple linear regression. The standard errors of the <span class="math notranslate nohighlight">\(b\)</span>’s have more complicated formulas, but all are multiples of the estimated model standard deviation <span class="math notranslate nohighlight">\(s\)</span>. We again rely on statistical software to do these calculations.</p>
<p><strong>Confidence Intervals &amp; Tests for <span class="math notranslate nohighlight">\(\beta_j\)</span></strong></p>
<p>A level <span class="math notranslate nohighlight">\(C\)</span> <strong>confidence interval</strong> for <span class="math notranslate nohighlight">\(\beta_j\)</span> is</p>
<div class="math notranslate nohighlight">
\[b_j \;\pm\; t^* \,\text{SE}_{b_j},\]</div>
<p>where <span class="math notranslate nohighlight">\(\text{SE}_{b_j}\)</span> is the standard error of <span class="math notranslate nohighlight">\(b_j\)</span>, and <span class="math notranslate nohighlight">\(t^*\)</span> is the critical value from the <span class="math notranslate nohighlight">\(t(n - p - 1)\)</span> distribution such that the area under the curve between <span class="math notranslate nohighlight">\(-t^*\)</span> and <span class="math notranslate nohighlight">\(t^*\)</span> is <span class="math notranslate nohighlight">\(C\)</span>.</p>
<p>To test the hypothesis <span class="math notranslate nohighlight">\(H_0\!: \beta_j = \beta_j^*\)</span>, compute the <strong>test statistic</strong>:</p>
<div class="math notranslate nohighlight">
\[t \;=\; \frac{b_j - \beta_j^*}{\text{SE}_{b_j}}.\]</div>
<p>Most software packages default to testing <span class="math notranslate nohighlight">\(H_0\!: \beta_j = 0\)</span>. In that case, the test statistic reduces to:</p>
<div class="math notranslate nohighlight">
\[t \;=\; \frac{b_j}{\text{SE}_{b_j}}.\]</div>
<p>If <span class="math notranslate nohighlight">\(T\)</span> has a <span class="math notranslate nohighlight">\(t(n - p - 1)\)</span> distribution, the <span class="math notranslate nohighlight">\(P\)</span>-value for</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(H_a\!: \beta_j &gt; 0 \quad\Rightarrow\quad P(T \ge t)\)</span></p></li>
<li><p><span class="math notranslate nohighlight">\(H_a\!: \beta_j &lt; 0 \quad\Rightarrow\quad P(T \le t)\)</span></p></li>
<li><p><span class="math notranslate nohighlight">\(H_a\!: \beta_j \ne 0 \quad\Rightarrow\quad 2\,P(T \ge |t|)\)</span></p></li>
</ul>
<p><strong>Software Tips and Prediction Use</strong></p>
<div class="warning admonition">
<p class="admonition-title">Important</p>
<p>Be <strong>very careful</strong> interpreting <span class="math notranslate nohighlight">\(t\)</span> tests and confidence intervals for individual regression coefficients.</p>
</div>
<p>In <strong>simple</strong> linear regression, the model <span class="math notranslate nohighlight">\(\mu_y = \beta_0 + \beta_1 x\)</span> implies <span class="math notranslate nohighlight">\(H_0\!: \beta_1 = 0\)</span> means <span class="math notranslate nohighlight">\(x\)</span> adds no predictive value for <span class="math notranslate nohighlight">\(y\)</span>.</p>
<p>In <strong>multiple</strong> regression,</p>
<div class="math notranslate nohighlight">
\[\mu_y 
= \beta_0 
  + \beta_1 x_1 
  + \beta_2 x_2 
  + \dots 
  + \beta_p x_p,\]</div>
<p>the hypothesis <span class="math notranslate nohighlight">\(H_0\!: \beta_1 = 0\)</span> means <span class="math notranslate nohighlight">\(x_1\)</span> adds no value for predicting <span class="math notranslate nohighlight">\(y\)</span>, <strong>given</strong> that <span class="math notranslate nohighlight">\(x_2, \dots, x_p\)</span> are already in the model.</p>
<p>In most software, the same commands that give confidence and prediction intervals in simple regression also work for multiple regression, with the only difference being that we specify multiple explanatory variables instead of just one.</p>
</div>
<input id="sd-tab-item-5" name="sd-tab-set-1" type="radio">
<label class="sd-tab-label" for="sd-tab-item-5">
ANOVA Table for Multiple Regression</label><div class="sd-tab-content docutils">
<p>In multiple regression, the <strong><span class="math notranslate nohighlight">\(F\)</span> test</strong> from the <strong>ANOVA table</strong> checks whether all the regression coefficients (except the intercept) are zero.</p>
<p><strong>ANOVA Table Format</strong>:</p>
<div class="pst-scrollable-table-container"><table class="table" id="id1">
<caption><span class="caption-number">Table 13.1 </span><span class="caption-text">ANOVA Table</span><a class="headerlink" href="#id1" title="Link to this table">#</a></caption>
<colgroup>
<col style="width: 18.8%" />
<col style="width: 18.8%" />
<col style="width: 25.0%" />
<col style="width: 25.0%" />
<col style="width: 12.5%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Source</p></th>
<th class="head"><p>Degrees of Freedom</p></th>
<th class="head"><p>Sum of Squares</p></th>
<th class="head"><p>Mean Square</p></th>
<th class="head"><p>F</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Model</p></td>
<td><p><span class="math notranslate nohighlight">\(p\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(\sum (\hat{y}_i - \bar{y})^2\)</span></p></td>
<td><p>SSM / DFM</p></td>
<td><p>MSM / MSE</p></td>
</tr>
<tr class="row-odd"><td><p>Error</p></td>
<td><p><span class="math notranslate nohighlight">\(n - p - 1\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(\sum (y_i - \hat{y}_i)^2\)</span></p></td>
<td><p>SSE / DFE</p></td>
<td></td>
</tr>
<tr class="row-even"><td><p>Total</p></td>
<td><p><span class="math notranslate nohighlight">\(n - 1\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(\sum (y_i - \bar{y})^2\)</span></p></td>
<td><p>SST / DFT</p></td>
<td></td>
</tr>
</tbody>
</table>
</div>
<p>We have</p>
<div class="math notranslate nohighlight">
\[\text{SST} = \text{SSM} + \text{SSE}, 
\quad
\text{DFT} = \text{DFM} + \text{DFE}.\]</div>
<p>The estimate of <span class="math notranslate nohighlight">\(\sigma^2\)</span> is again the <strong>mean square error</strong> (MSE) from the ANOVA table:</p>
<div class="math notranslate nohighlight">
\[s^2 = \text{MSE}.\]</div>
<p><strong>Interpretation of the <span class="math notranslate nohighlight">\(F\)</span> Statistic</strong></p>
<p>The ratio <span class="math notranslate nohighlight">\(\text{MSM} / \text{MSE}\)</span> is the <strong><span class="math notranslate nohighlight">\(F\)</span> statistic</strong> for testing:</p>
<div class="math notranslate nohighlight">
\[H_0\!: \beta_1 = \beta_2 = \cdots = \beta_p = 0
\quad\text{vs.}\quad
H_a\!: \text{at least one of the } \beta_j \text{ is not } 0.\]</div>
<p>Large <span class="math notranslate nohighlight">\(F\)</span> values give evidence <strong>against</strong> <span class="math notranslate nohighlight">\(H_0\)</span>. When <span class="math notranslate nohighlight">\(H_0\)</span> is true, <span class="math notranslate nohighlight">\(F\)</span> has the <span class="math notranslate nohighlight">\(F(p,\,n - p - 1)\)</span> distribution.</p>
<p><strong>Analysis of Variance <span class="math notranslate nohighlight">\(F\)</span> Test (Multiple Regression)</strong></p>
<div class="math notranslate nohighlight">
\[H_0\!: \beta_1 = \beta_2 = \cdots = \beta_p = 0 
\quad\text{vs.}\quad 
H_a\!: \text{at least one } \beta_j \ne 0.\]</div>
<div class="math notranslate nohighlight">
\[F = \frac{\text{MSM}}{\text{MSE}},\]</div>
<p>and the <span class="math notranslate nohighlight">\(P\)</span>-value is <span class="math notranslate nohighlight">\(P\bigl(F(p,\,n - p - 1)\,\ge\,F_{\text{obs}}\bigr)\)</span>.</p>
<p><strong>Common Misinterpretation of the <span class="math notranslate nohighlight">\(F\)</span> Test</strong></p>
<div class="warning admonition">
<p class="admonition-title">Warning</p>
<p>A common error in multiple regression is to assume that <strong>all</strong> coefficients are nonzero whenever <span class="math notranslate nohighlight">\(F\)</span> has a small <span class="math notranslate nohighlight">\(P\)</span>-value.</p>
</div>
<p>The <span class="math notranslate nohighlight">\(F\)</span> test provides an <strong>overall</strong> assessment of the regression model in explaining <span class="math notranslate nohighlight">\(y\)</span>, while the <strong>individual <span class="math notranslate nohighlight">\(t\)</span> tests</strong> look at each variable’s importance <strong>given</strong> the others. Especially with correlated explanatory variables, a small <span class="math notranslate nohighlight">\(P\)</span>-value for <span class="math notranslate nohighlight">\(F\)</span> does not guarantee each <span class="math notranslate nohighlight">\(\beta_j\)</span> is statistically significant.</p>
</div>
<input id="sd-tab-item-6" name="sd-tab-set-1" type="radio">
<label class="sd-tab-label" for="sd-tab-item-6">
Squared multiple correlation <span class="math notranslate nohighlight">\(R^2\)</span></label><div class="sd-tab-content docutils">
<p>For simple linear regression, we noted that the square of the sample correlation could be written as the ratio of SSM to SST and could be interpreted as the proportion of variation in <span class="math notranslate nohighlight">\(y\)</span> explained by <span class="math notranslate nohighlight">\(x\)</span>. The ratio of SSM to SST is routinely calculated for multiple regression and still can be interpreted as the proportion of explained variation. The difference is that it relates to the collection of explanatory variables in the model.</p>
<p><strong>The statistic</strong>
<span class="math notranslate nohighlight">\(
R^2 = \frac{\text{SSM}}{\text{SST}} = \frac{\sum (\hat{y}_i - \bar{y})^2}{\sum (y_i - \bar{y})^2}
\)</span></p>
<p><em>is the proportion of the variation of the response variable <span class="math notranslate nohighlight">\(y\)</span> that is explained by the explanatory variables <span class="math notranslate nohighlight">\(x_1, x_2, \ldots, x_p\)</span> in a multiple linear regression.</em></p>
<p>We use a capital <span class="math notranslate nohighlight">\(R\)</span> here to reinforce the fact that this statistic depends on a collection of explanatory variables. Often, <span class="math notranslate nohighlight">\(R^2\)</span> is multiplied by 100 and expressed as a percent. The square root of <span class="math notranslate nohighlight">\(R^2\)</span>, called the <strong>multiple correlation coefficient</strong>, is the correlation between the observations <span class="math notranslate nohighlight">\(y_i\)</span> and the predicted values <span class="math notranslate nohighlight">\(\hat{y}_i\)</span>. Some software provides a scatterplot of this relationship to help visualize the predictive strength of the model.</p>
</div>
<input id="sd-tab-item-7" name="sd-tab-set-1" type="radio">
<label class="sd-tab-label" for="sd-tab-item-7">
Tests</label><div class="sd-tab-content docutils">
<figure class="align-center">
<a class="reference internal image-reference" href="_images/1206.png"><img alt="$t$ tests" src="_images/1206.png" style="width: 80%;" /></a>
</figure>
<figure class="align-center">
<a class="reference internal image-reference" href="_images/1207.png"><img alt="$F$ tests" src="_images/1207.png" style="width: 80%;" /></a>
</figure>
</div>
</div>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="chapter12.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title"><span class="section-number">12. </span>Chapter 10: Inference for Regression</p>
      </div>
    </a>
    <a class="right-next"
       href="chapter14.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title"><span class="section-number">14. </span>Chapter 2 &amp; 9: Two-Way Tables</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <dialog id="pst-secondary-sidebar-modal"></dialog>
                <div id="pst-secondary-sidebar" class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#the-model-and-estimation">13.1. The model and estimation</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#confidence-intervals-significant-tests-and-anova">13.2. Confidence intervals, significant tests and ANOVA</a></li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Frank (Chenzhong) Wu
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2024.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script defer src="_static/scripts/bootstrap.js?digest=8878045cc6db502f8baf"></script>
<script defer src="_static/scripts/pydata-sphinx-theme.js?digest=8878045cc6db502f8baf"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>